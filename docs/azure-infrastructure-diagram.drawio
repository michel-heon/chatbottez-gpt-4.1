<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.0.6 Chrome/138.0.7204.100 Electron/37.2.3 Safari/537.36" version="28.0.6">
  <diagram name="Azure Infrastructure Architecture" id="azure-infra">
    <mxGraphModel dx="1422" dy="982" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="980" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="ChatBottez GPT-4.1 - Azure Infrastructure Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1;fontColor=#0078D4;" parent="1" vertex="1">
          <mxGeometry x="350" y="20" width="700" height="40" as="geometry" />
        </mxCell>
        
        <!-- Azure Subscription Box -->
        <mxCell id="subscription-box" value="Azure Subscription: Microsoft Azure Sponsorship&#xa;Subscription ID: 0f1323ea-0f29-4187-9872-e1cf15d677de" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#0078D4;fillColor=#E1F5FE;fontSize=12;fontStyle=1;verticalAlign=top;dashed=1;dashPattern=5 5;" parent="1" vertex="1">
          <mxGeometry x="50" y="80" width="1300" height="840" as="geometry" />
        </mxCell>
        
        <!-- Resource Group -->
        <mxCell id="rg-box" value="Resource Group: rg-chatbottez-gpt-4-1-dev-02&#xa;Location: Canada Central" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#2E7D32;fillColor=#E8F5E8;fontSize=16;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="100" y="140" width="1200" height="750" as="geometry" />
        </mxCell>
        
        <!-- Network Security Section -->
        <mxCell id="network-box" value="Network &amp; Security" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#FF6D00;fillColor=#FFF3E0;fontSize=14;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="130" y="190" width="350" height="200" as="geometry" />
        </mxCell>
        
        <!-- Virtual Network -->
        <mxCell id="vnet" value="Virtual Network&#xa;chatbottez-vnet" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#1976D2;fillColor=#E3F2FD;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="150" y="230" width="130" height="50" as="geometry" />
        </mxCell>
        
        <!-- Network Security Group -->
        <mxCell id="nsg" value="Network Security Group&#xa;Database Access Rules" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#E65100;fillColor=#FFF3E0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="300" y="230" width="160" height="50" as="geometry" />
        </mxCell>
        
        <!-- Firewall Rules -->
        <mxCell id="firewall" value="Firewall Rules&#xa;â€¢ Allow Azure Services&#xa;â€¢ Dev: Allow All IPs&#xa;â€¢ Prod: Restricted IPs" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#C62828;fillColor=#FFEBEE;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="150" y="300" width="310" height="70" as="geometry" />
        </mxCell>
        
        <!-- Database Section -->
        <mxCell id="database-box" value="Database Services" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#1565C0;fillColor=#E3F2FD;fontSize=14;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="520" y="190" width="400" height="280" as="geometry" />
        </mxCell>
        
        <!-- PostgreSQL Server -->
        <mxCell id="postgres" value="PostgreSQL Flexible Server&#xa;gpt-4-1-postgres-dev-rdazbuglrttd6" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#0D47A1;fillColor=#E3F2FD;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="540" y="230" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- Database Details -->
        <mxCell id="db-details" value="Configuration:&#xa;â€¢ Version: PostgreSQL 16&#xa;â€¢ SKU: Standard_B1ms&#xa;â€¢ Storage: 32 GB&#xa;â€¢ Backup: 7 days retention&#xa;â€¢ SSL: Required" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#616161;fillColor=#F5F5F5;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="760" y="230" width="140" height="90" as="geometry" />
        </mxCell>
        
        <!-- Database Schema -->
        <mxCell id="db-schema" value="Database: marketplace_quota&#xa;&#xa;Tables:&#xa;â€¢ subscriptions&#xa;â€¢ usage_events&#xa;â€¢ audit_logs&#xa;&#xa;Users:&#xa;â€¢ pgadmin (admin)&#xa;â€¢ marketplace_user (app)" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#4CAF50;fillColor=#F1F8E9;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="540" y="310" width="200" height="140" as="geometry" />
        </mxCell>
        
        <!-- Connection Strings -->
        <mxCell id="conn-strings" value="Connection Management:&#xa;â€¢ Admin Connection String&#xa;â€¢ App Connection String&#xa;â€¢ SSL Mode: Require&#xa;â€¢ Port: 5432" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#FF9800;fillColor=#FFF8E1;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="760" y="340" width="140" height="110" as="geometry" />
        </mxCell>
        
        <!-- Security Section -->
        <mxCell id="security-box" value="Security &amp; Secrets Management" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#7B1FA2;fillColor=#F3E5F5;fontSize=14;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="960" y="190" width="320" height="280" as="geometry" />
        </mxCell>
        
        <!-- Key Vault -->
        <mxCell id="keyvault" value="Azure Key Vault&#xa;kvgpt41devrdazbuglrttd6" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#4A148C;fillColor=#F3E5F5;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="980" y="230" width="180" height="60" as="geometry" />
        </mxCell>
        
        <!-- Key Vault Details -->
        <mxCell id="kv-details" value="Configuration:&#xa;â€¢ SKU: Standard&#xa;â€¢ Access Policy Model&#xa;â€¢ Soft Delete: Enabled&#xa;â€¢ Purge Protection: Disabled" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#616161;fillColor=#F5F5F5;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="1180" y="230" width="80" height="90" as="geometry" />
        </mxCell>
        
        <!-- Secrets -->
        <mxCell id="secrets" value="Stored Secrets:&#xa;&#xa;ðŸ”‘ postgres-admin-connection-string&#xa;   â””â”€ Admin database access&#xa;&#xa;ðŸ”‘ postgres-app-connection-string&#xa;   â””â”€ Application database access&#xa;&#xa;ðŸ”‘ marketplace-api-keys (future)&#xa;   â””â”€ Microsoft Marketplace tokens" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#E91E63;fillColor=#FCE4EC;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="980" y="310" width="280" height="140" as="geometry" />
        </mxCell>
        
        <!-- API Management Section -->
        <mxCell id="apim-box" value="API Management &amp; Gateway" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#FF5722;fillColor=#FFF3E0;fontSize=14;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="130" y="500" width="590" height="200" as="geometry" />
        </mxCell>
        
        <!-- APIM Instance -->
        <mxCell id="apim" value="API Management&#xa;apim-chatbottez-gpt-4-1-dev-02" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#D84315;fillColor=#FFF3E0;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="150" y="540" width="200" height="60" as="geometry" />
        </mxCell>
        
        <!-- APIM Features -->
        <mxCell id="apim-features" value="Features:&#xa;â€¢ Consumption Tier&#xa;â€¢ Quota Policies (300/month)&#xa;â€¢ Rate Limiting&#xa;â€¢ Subscription Keys&#xa;â€¢ Analytics &amp; Monitoring" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#616161;fillColor=#F5F5F5;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="370" y="540" width="160" height="100" as="geometry" />
        </mxCell>
        
        <!-- APIM Policies -->
        <mxCell id="apim-policies" value="Quota Management:&#xa;&#xa;ðŸ“Š Policy Configuration:&#xa;â€¢ quota-by-key (subscription)&#xa;â€¢ 300 requests per month&#xa;â€¢ Reset period: monthly&#xa;â€¢ Error handling: HTTP 429" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#1976D2;fillColor=#E3F2FD;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="550" y="540" width="160" height="100" as="geometry" />
        </mxCell>
        
        <!-- Monitoring Section -->
        <mxCell id="monitoring-box" value="Monitoring &amp; Observability" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#E65100;fillColor=#FFF3E0;fontSize=14;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="760" y="500" width="520" height="200" as="geometry" />
        </mxCell>
        
        <!-- Application Insights -->
        <mxCell id="app-insights" value="Application Insights&#xa;gpt41-appinsights-dev" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#F57C00;fillColor=#FFF8E1;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="780" y="540" width="160" height="50" as="geometry" />
        </mxCell>
        
        <!-- Azure Monitor -->
        <mxCell id="azure-monitor" value="Azure Monitor&#xa;â€¢ Metrics &amp; Alerts&#xa;â€¢ Log Analytics&#xa;â€¢ Performance Counters" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#689F38;fillColor=#F1F8E9;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="960" y="540" width="140" height="70" as="geometry" />
        </mxCell>
        
        <!-- Storage for Logs -->
        <mxCell id="storage" value="Azure Storage&#xa;â€¢ Failed Events Queue&#xa;â€¢ Audit Logs Archive&#xa;â€¢ Backup Storage" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#0277BD;fillColor=#E1F5FE;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1120" y="540" width="140" height="70" as="geometry" />
        </mxCell>
        
        <!-- Deployment Section -->
        <mxCell id="deployment-box" value="Deployment &amp; Management" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#795548;fillColor=#EFEBE9;fontSize=14;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="130" y="730" width="1150" height="140" as="geometry" />
        </mxCell>
        
        <!-- Infrastructure as Code -->
        <mxCell id="iac" value="Infrastructure as Code&#xa;Azure Bicep Templates" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#5D4037;fillColor=#EFEBE9;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="150" y="770" width="180" height="50" as="geometry" />
        </mxCell>
        
        <!-- Deployment Scripts -->
        <mxCell id="deploy-scripts" value="Deployment Automation:&#xa;â€¢ azure-deploy.sh&#xa;â€¢ azure-configure.sh&#xa;â€¢ database-setup.sh&#xa;â€¢ environment-setup.sh" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#4CAF50;fillColor=#F1F8E9;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="350" y="770" width="180" height="80" as="geometry" />
        </mxCell>
        
        <!-- Configuration Management -->
        <mxCell id="config-mgmt" value="Configuration:&#xa;â€¢ config/azure.env&#xa;â€¢ env/.env.local&#xa;â€¢ Makefile orchestration" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#FF9800;fillColor=#FFF8E1;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="550" y="770" width="160" height="80" as="geometry" />
        </mxCell>
        
        <!-- Validation -->
        <mxCell id="validation" value="Validation System:&#xa;â€¢ 15 automated checks&#xa;â€¢ Connectivity tests&#xa;â€¢ Permission validation&#xa;â€¢ Health monitoring" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#9C27B0;fillColor=#F3E5F5;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="730" y="770" width="160" height="80" as="geometry" />
        </mxCell>
        
        <!-- Environment Management -->
        <mxCell id="env-mgmt" value="Environment Management:&#xa;â€¢ Development: All IPs allowed&#xa;â€¢ Production: Restricted access&#xa;â€¢ Staging: Controlled access&#xa;â€¢ Tags: Project, Environment, Purpose" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#607D8B;fillColor=#ECEFF1;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="910" y="770" width="200" height="80" as="geometry" />
        </mxCell>
        
        <!-- Version Info -->
        <mxCell id="version-info" value="Current Version: v1.6.0-step5-wsl-validation&#xa;Last Updated: August 18, 2025&#xa;Status: Infrastructure Deployed âœ…" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#37474F;fillColor=#ECEFF1;fontSize=10;align=left;" parent="1" vertex="1">
          <mxGeometry x="1130" y="770" width="140" height="80" as="geometry" />
        </mxCell>
        
        <!-- Connections -->
        
        <!-- VNet to PostgreSQL -->
        <mxCell id="conn1" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#1976D2;strokeWidth=2;" parent="1" source="vnet" target="postgres" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="400" y="300" as="sourcePoint" />
            <mxPoint x="450" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Key Vault to PostgreSQL -->
        <mxCell id="conn2" value="Secure Connection Strings" style="endArrow=classic;html=1;rounded=0;strokeColor=#7B1FA2;strokeWidth=2;" parent="1" source="keyvault" target="postgres" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="300" as="sourcePoint" />
            <mxPoint x="850" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- APIM to Application (future) -->
        <mxCell id="conn3" value="API Gateway" style="endArrow=classic;html=1;rounded=0;strokeColor=#FF5722;strokeWidth=2;dashed=1;" parent="1" source="apim" target="postgres" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="300" y="450" as="sourcePoint" />
            <mxPoint x="500" y="350" as="targetPoint" />
            <Array as="points">
              <mxPoint x="400" y="450" />
              <mxPoint x="500" y="400" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Monitoring connections -->
        <mxCell id="conn4" value="Telemetry" style="endArrow=classic;html=1;rounded=0;strokeColor=#E65100;strokeWidth=1;dashed=1;" parent="1" source="postgres" target="app-insights" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="650" y="400" as="sourcePoint" />
            <mxPoint x="800" y="500" as="targetPoint" />
            <Array as="points">
              <mxPoint x="700" y="350" />
              <mxPoint x="800" y="450" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-box" value="Legend" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#333333;fillColor=#F8F9FA;fontSize=12;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="1350" y="140" width="200" height="300" as="geometry" />
        </mxCell>
        
        <mxCell id="legend1" value="ðŸŒ Network &amp; Security" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#FF6D00;fillColor=#FFF3E0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1360" y="170" width="180" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend2" value="ðŸ—„ï¸ Database Services" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#1565C0;fillColor=#E3F2FD;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1360" y="200" width="180" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend3" value="ðŸ” Security &amp; Secrets" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#7B1FA2;fillColor=#F3E5F5;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1360" y="230" width="180" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend4" value="ðŸš€ API Management" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#FF5722;fillColor=#FFF3E0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1360" y="260" width="180" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend5" value="ðŸ“Š Monitoring" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#E65100;fillColor=#FFF3E0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1360" y="290" width="180" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend6" value="âš™ï¸ Deployment" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#795548;fillColor=#EFEBE9;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1360" y="320" width="180" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend7" value="â”€â”€â”€â”€ Active Connection" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1360" y="360" width="180" height="15" as="geometry" />
        </mxCell>
        
        <mxCell id="legend8" value="- - - - Future Connection" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1360" y="380" width="180" height="15" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
